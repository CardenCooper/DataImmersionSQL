### Code for finding the top 10 countries with the most customers.
SELECT country,
COUNT(customer_id) AS customer_count
FROM customer
INNER JOIN address ON customer.address_id = address.address_id
INNER JOIN city ON address.city_id = city.city_id
INNER JOIN country ON city.country_id = country.country_id
GROUP BY country
ORDER BY COUNT(customer_id) DESC
LIMIT 10

### Code for the cities with the most customers within those top 10 countries.
SELECT city, country,
COUNT (customer_id) AS customer_count
FROM customer
INNER JOIN address ON customer.address_id = address.address_id
INNER JOIN city ON address.city_id = city.city_id
INNER JOIN country ON city.country_id = country.country_id
WHERE country IN ('India', 'China', 'United States', 'Japan', 'Mexico', 'Brazil', 'Russian
Federation', 'Philippines', 'Turkey', 'Indonesia')
GROUP BY city, country
ORDER BY COUNT (customer_id) DESC
LIMIT 10

### Code for finding the top 5 customers from within those top 10 cities.
SELECT customer.customer_id, first_name, last_name, country, city,
SUM (payment.amount) AS total_payment
FROM customer
INNER JOIN payment ON customer.customer_id = payment.customer_id
INNER JOIN address ON customer.address_id = address.address_id
INNER JOIN city ON address.city_id = city.city_id
INNER JOIN country ON city.country_id = country.country_id
WHERE city IN ('Aurora', 'Atlixco', 'Xintai', 'Adoni', 'Dhule (Dhulia)', 'Kurashiki', 'Pingxiang',
'Sivas', 'Celaya', 'So Leopoldo')
AND country IN ('India', 'China', 'United States', 'Japan', 'Mexico', 'Brazil', 'Russian
Federation', 'Philippines', 'Turkey', 'Indonesia')
GROUP BY customer.customer_id, first_name, last_name, country, city
ORDER BY total_payment DESC
LIMIT 5
