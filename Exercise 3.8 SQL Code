### Code 1
SELECT AVG (total_payment) AS average_amount_paid FROM (SELECT
customer.customer_id, first_name, last_name, country, city, SUM (payment.amount) AS
total_payment FROM customer INNER JOIN payment ON customer.customer_id =
payment.customer_id
INNER JOIN address ON customer.address_id = address.address_id
INNER JOIN city ON address.city_id = city.city_id
INNER JOIN country ON city.country_id = country.country_id WHERE city IN ('Aurora',
'Atlixco', 'Xintai', 'Adoni', 'Dhule (Dhulia)', 'Kurashiki', 'Pingxiang', 'Sivas', 'Celaya', 'So
Leopoldo') AND country IN ('India', 'China', 'United States', 'Japan', 'Mexico', 'Brazil',
'Russian Federation', 'Philippines', 'Turkey', 'Indonesia') GROUP BY customer.customer_id,
first_name, last_name, country, city
ORDER BY total_payment DESC
LIMIT 5)

### Code 2
SELECT country.country, COUNT (DISTINCT customer.customer_id) AS
all_customer_count, COUNT (DISTINCT top_5_customers.customer_id) AS
top_5_customer_count FROM customer INNER JOIN address ON customer.address_id =
address.address_id
INNER JOIN city ON address.city_id = city.city_id
INNER JOIN country ON city.country_id = country.country_id LEFT JOIN (SELECT
customer.customer_id, first_name, last_name, country, city, SUM (payment.amount) AS
total_payment FROM customer INNER JOIN payment ON customer.customer_id =
payment.customer_id
INNER JOIN address ON customer.address_id = address.address_id
INNER JOIN city ON address.city_id = city.city_id
INNER JOIN country ON city.country_id = country.country_id WHERE city IN ('Aurora',
'Atlixco', 'Xintai', 'Adoni', 'Dhule (Dhulia)', 'Kurashiki', 'Pingxiang', 'Sivas', 'Celaya', 'So
Leopoldo') AND country IN ('India', 'China', 'United States', 'Japan', 'Mexico', 'Brazil',
'Russian Federation', 'Philippines', 'Turkey', 'Indonesia') GROUP BY customer.customer_id,
first_name, last_name, country, city
ORDER BY total_payment DESC
LIMIT 5) AS top_5_customers ON top_5_customers.country = country.country GROUP BY
country.country ORDER BY top_5_customer_count DESC, all_customer_count DESC LIMIT 5
